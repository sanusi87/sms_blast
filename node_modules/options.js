var mysql = require('conn');
var evt = require('events');
var evtEmitter = new evt.EventEmitter();
var util = require("util");

var options = function(){
	var t = this;
	evt.EventEmitter.call( t );
	
	// job level / position level
	t.jobLevel = function(){
		mysql.live.getConnection(function(err, conn){
			if( err ){
				t.emit('find_error', {error: err.toString()});
			}else{
				var strSQL = "SELECT * FROM job_level";
				conn.query(strSQL, function(err, rows){
					if( err ){
						t.emit('find_error', {error: err.toString()});
					}else{
						t.emit('find_success', rows);
					}
				});
			}
		});
	}
	
	// job type, permanent, temporary
	t.jobType = function(){
		mysql.live.getConnection(function(err, conn){
			if( err ){
				t.emit('find_error', {error: err.toString()});
			}else{
				var strSQL = "SELECT * FROM job_type";
				conn.query(strSQL, function(err, rows){
					if( err ){
						t.emit('find_error', {error: err.toString()});
					}else{
						t.emit('find_success', rows);
					}
				});
			}
		});
	}
	
	t.jobSpec = function(){
		mysql.live.getConnection(function(err, conn){
			if( err ){
				t.emit('find_error', {error: err.toString()});
			}else{
				var strSQL = "SELECT * FROM job_spec WHERE id >= 200";
				conn.query(strSQL, function(err, rows){
					if( err ){
						t.emit('find_error', {error: err.toString()});
					}else{
						t.emit('find_success', rows);
					}
				});
			}
		});
	}
	
	t.jobRole = function(){
		mysql.live.getConnection(function(err, conn){
			if( err ){
				t.emit('find_error', {error: err.toString()});
			}else{
				var strSQL = "SELECT * FROM job_role WHERE id >= 200";
				conn.query(strSQL, function(err, rows){
					if( err ){
						t.emit('find_error', {error: err.toString()});
					}else{
						t.emit('find_success', rows);
					}
				});
			}
		});
	}
	
	t.industry = function(){
		mysql.live.getConnection(function(err, conn){
			if( err ){
				t.emit('find_error', {error: err.toString()});
			}else{
				var strSQL = "SELECT * FROM industry";
				conn.query(strSQL, function(err, rows){
					if( err ){
						t.emit('find_error', {error: err.toString()});
					}else{
						t.emit('find_success', rows);
					}
				});
			}
		});
	}
	
	t.eduLevel = function(){
		mysql.live.getConnection(function(err, conn){
			if( err ){
				t.emit('find_error', {error: err.toString()});
			}else{
				var strSQL = "SELECT * FROM edu_level";
				conn.query(strSQL, function(err, rows){
					if( err ){
						t.emit('find_error', {error: err.toString()});
					}else{
						t.emit('find_success', rows);
					}
				});
			}
		});
	}
	
	t.eduField = function(){
		mysql.live.getConnection(function(err, conn){
			if( err ){
				t.emit('find_error', {error: err.toString()});
			}else{
				var strSQL = "SELECT * FROM edu_field";
				conn.query(strSQL, function(err, rows){
					if( err ){
						t.emit('find_error', {error: err.toString()});
					}else{
						t.emit('find_success', rows);
					}
				});
			}
		});
	}
	
	t.country = function(){
		mysql.live.getConnection(function(err, conn){
			if( err ){
				t.emit('find_error', {error: err.toString()});
			}else{
				var strSQL = "SELECT * FROM country";
				conn.query(strSQL, function(err, rows){
					if( err ){
						t.emit('find_error', {error: err.toString()});
					}else{
						t.emit('find_success', rows);
					}
				});
			}
		});
	}
	
	t.city = function(state){
		mysql.live.getConnection(function(err, conn){
			if( err ){
				t.emit('find_error', {error: err.toString()});
			}else{
				var param = [];
				var strSQL = "SELECT * FROM city WHERE state_id=?";
				param.push(state);
				conn.query(strSQL, param, function(err, rows){
					if( err ){
						t.emit('find_error', {error: err.toString()});
					}else{
						t.emit('find_success', rows);
					}
				});
			}
		});
	}
	
	t.state = function(){
		mysql.live.getConnection(function(err, conn){
			if( err ){
				t.emit('find_error', {error: err.toString()});
			}else{
				var strSQL = "SELECT * FROM state WHERE country_id=127";
				conn.query(strSQL, function(err, rows){
					if( err ){
						t.emit('find_error', {error: err.toString()});
					}else{
						t.emit('find_success', rows);
					}
				});
			}
		});
	}
	
	t.language = function(){
		mysql.live.getConnection(function(err, conn){
			if( err ){
				t.emit('find_error', {error: err.toString()});
			}else{
				var strSQL = "SELECT * FROM language";
				conn.query(strSQL, function(err, rows){
					if( err ){
						t.emit('find_error', {error: err.toString()});
					}else{
						t.emit('find_success', rows);
					}
				});
			}
		});
	}
	
	t.languageLevel = function(){
		mysql.live.getConnection(function(err, conn){
			if( err ){
				t.emit('find_error', {error: err.toString()});
			}else{
				var strSQL = "SELECT * FROM language_level";
				conn.query(strSQL, function(err, rows){
					if( err ){
						t.emit('find_error', {error: err.toString()});
					}else{
						t.emit('find_success', rows);
					}
				});
			}
		});
	}
}